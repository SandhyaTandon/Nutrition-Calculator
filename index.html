<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8" />
  <title>Nutrient Label Calculator</title>

  <!-- google fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet">

  <!-- css Stylesheets-->
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <!-- bootstrap scripts -->

</head>

<body>
  <!-- heading -->
  <h1 class="display-2">Nutrition Calculator</h1>

  <!-- steps section -->
  <section id="steps">
    <div class="row container-fluid steps-div">
      <div class="col-lg-4">
        <img src="https://www.verywellfit.com/static/4.151.0/image/recipe_analyzer_step1.png" class="steps-image" />
        <p>Enter Your Ingredients</p>
      </div>
      <div class="col-lg-4">
        <img src="https://www.verywellfit.com/static/4.151.0/image/recipe_analyzer_step2.png" class="steps-image" />
        <p>Click on 'Analyze Recipe'</p>
      </div>
      <div class="col-lg-4">
        <img src="https://www.verywellfit.com/static/4.151.0/image/recipe_analyzer_step3.png" class="steps-image" />
        <p>Get Your Nutrition Facts Label</p
      </div>
    </div>
  </section>

  <!-- calculator body -->

  <section id="calculator-body">
    <div class="container-fluid card border-secondry" id="box1">
      <div class="card bg-light mb-3">
        <div class="card-body">
          <h4 class="card-title">Enter Recipe Name (optional)</h4>
          <input class="recipe-name card-text form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default" id="recipeName" />
          <div class="raw-data ">
            <header>
              <h4 class="card-title">Enter Recipe Ingredients</h4>
              <nav>
                <a class="example-recipe" href="">Try a Sample Recipe</a>
              </nav>
            </header>
            <textarea class="form-control" rows="10" id="recipeIngredients"></textarea>
            <div id="servings_1-1" class="row servings">
              <div class="col-6 serving-number">
                <h4 class="card-title">Select Number of Servings</h4>
                <div class="select">
                  <select id="numOfServing" class="form-control">
                    <option value="null" selected="selected" disabled="disabled" hidden="hidden">
                      ---
                    </option>
                  </select>
                </div>
              </div>
              <div class="serving-size col-6">
                <h4 class="card-title">Enter serving size (optional)</h4>
                <input placeholder="e.g. 2 cups, 1 tablespoon" class="serving-size-quantity form-control" aria-label="large" aria-describedby="inputGroup-sizing-large " id="servingSize" />
              </div>
            </div>
            <button class="btn btn-submit btn-dark btn-lg" id="analyze">
              Analyze Recipe
            </button>
          </div>

          <!-- output -->
          <div id="nutrientResult">
            <br />
            <br />
            <div class="row">
              <div class="col-sm">
                <h3 class="display-4">Recipe Analyzer Results <br /></h3>
                <p>A single serving of this recipe has
                  <b><span class="calories"> </span></b> calories. <br />
                  Read through the nutrition label for a snapshot of this
                  recipe's nutritional profile. If the label lists less than 5
                  percent daily value for a nutrient it is considered low, while
                  20 percent or more is high. In general, you want to limit
                  saturated fat, cholesterol, and sodium, and get enough fiber,
                  vitamins, and minerals.
                </p>
              </div>
              <div class="col-sm">
                <div class="card">
                  <div class="card-body">
                    <h3 class="display-6">Nutrition Facts <br /></h4>
                    <table class="nutrition-facts table">
                      <h6 class="display-6">Servings: <span id="serving"></span><br /></h6>
                      <hr>
                      <h6 class="display-6">Amount per serving <br /></h6>
                      <h5 class="display-5">Calories: <span class="calories"></span> <br /></h6>
                        <tr>
                          <th></th>
                          <th>Amount(g)</th>
                          <th>% Daily Value*</th>
                        </tr>
                        <tr>
                          <td> <b>Total Fat</b> </td>
                          <td><span id="totalFat"></span></td>
                          <td></td>
                        </tr>
                        <tr>
                          <td>Saturated Fat</td>
                          <td><span id="saturatedFat"></span></td>
                          <td></td>
                        </tr>
                        <tr>
                          <td> <b>Cholesterol</b> </td>
                          <td><span id="cholestrol"></span></td>
                          <td></td>
                        </tr>
                        <tr>
                          <td> <b>Sodium</b> </td>
                          <td><span id="sodium"></span></td>
                          <td></td>
                        </tr><tr>
                          <td> <b>Total Carbohydrate</b> </td>
                          <td><span id="totalCarbs"></span></td>
                          <td></td>
                        </tr><tr>
                          <td>Dietary Fiber</td>
                          <td><span id="dietaryFiber"></span></td>
                          <td></td>
                        </tr><tr>
                          <td> Total Sugars</td>
                          <td><span id="totalSugar"></span></td>
                          <td></td>
                        </tr>
                        <tr>
                          <td> <b> Protein</b></td>
                          <td><span id="protein"></span></td>
                          <td></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <button class="btn btn-padded btn-submit btn-primary" id="clear">
              Clear Recipe
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- scripts for bootstrap js -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
  </script>
</body>
<script>
  let select = document.getElementById("numOfServing");
  for (let i = 1; i <= 72; i++) {
    let opt = document.createElement("option");
    opt.value = i;
    opt.innerHTML = i;
    select.appendChild(opt);
  }

  $("#nutrientResult").hide();

  $("#analyze").click(function() {
    let arrayOfLines = $("#recipeIngredients")
      .val()
      .split("\n");
    let numOfServing = $("#numOfServing").val();
    let recipeName = $("#recipeName").val();
    let jsonObj = {
      title: recipeName,
      ingr: arrayOfLines,
      yield: numOfServing
    };
    let jsonobj = JSON.stringify(jsonObj);
    const xhr = new XMLHttpRequest();
    xhr.open(
      "POST",
      "https://api.edamam.com/api/nutrition-details?app_id=4426de42&app_key=345b8cfd43f0f84956e187cdfeacb13d"
    );
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onload = function() {
      let jsonResponse = xhr.response;
      let responseObj = JSON.parse(jsonResponse);
      console.log(responseObj);
      if (responseObj.error) {
        alert("Low quality input");
      } else {
        $("#nutrientResult").show();
        $("#serving").html(responseObj.yield);
        $(".calories").html(responseObj.calories);
        $("#totalFat").html(responseObj.totalNutrients.FAT.quantity.toFixed(2));
        $("#saturatedFat").html(
          responseObj.totalNutrients.FASAT.quantity.toFixed(2)
        );
        $("#cholestrol").html(
          responseObj.totalNutrients.CHOLE.quantity.toFixed(2)
        );
        $("#sodium").html(responseObj.totalNutrients.NA.quantity.toFixed(2));
        $("#totalCarbs").html(
          responseObj.totalNutrients.CHOCDF.quantity.toFixed(2)
        );
        $("#dietaryFiber").html(
          responseObj.totalNutrients.FIBTG.quantity.toFixed(2)
        );
        $("#totalSugar").html(
          responseObj.totalNutrients.SUGAR.quantity.toFixed(2)
        );
        $("#protein").html(
          responseObj.totalNutrients.PROCNT.quantity.toFixed(2)
        );
      };
    }
    xhr.send(jsonobj);
  });


  $("#clear").click(function() {
    $("#recipeIngredients").val("");
    $("#recipeName").val("");
    $("#numOfServing").val(null);
    $("#servingSize").val("");
    $("#nutrientResult").hide();
  });
</script>

</html>
